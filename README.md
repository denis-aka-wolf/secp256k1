# secp256k1

Программа командной строки для генерации открытого ключа secp256k1 по заданному закрытому ключу и решения задачи дискретного логарифмирования с помощью алгоритма BSGS (Baby-Step Giant-Step).

## Описание

Эта программа реализует:

1. Алгоритм генерации открытого ключа эллиптической кривой secp256k1 методом скалярного умножения точки на число (Double-and-Add).
2. Алгоритм BSGS (Baby-Step Giant-Step) для решения задачи дискретного логарифмирования на эллиптической кривой secp256k1.
3. Алгоритм поиска закрытого ключа по заданной координате X с автоматическим вычислением возможных значений Y и проверкой обеих возможных точек.

Программа принимает закрытый ключ в качестве аргумента командной строки и выводит соответствующий ему открытый ключ в формате HEX.

## Использование

### Генерация открытого ключа

```bash
dart run bin/cli.dart <закрытый_ключ>
```

Пример:

```bash
dart run bin/cli.dart 23288
```

### Решение задачи дискретного логарифмирования с помощью BSGS

```bash
dart run bin/bsgs.dart <Qx> <Qy> [fileName] [m]
```

Где:

- `<Qx>` и `<Qy>` - координаты целевой точки Q в hex формате
- `[fileName]` - имя файла с baby-steps (по умолчанию "data/baby_steps.bin")
- `[m]` - размер подмассива (по умолчанию 1000)

Пример:

```bash
dart run bin/bsgs.dart 39137f8a6ce2fdc692cc7ed51740544fa326171dee387630f6a616009714828f 23cb2af1cf2c168d612bae86b75871265062bccdabc338ae25f3d3a1605bd783
```

### Поиск закрытого ключа по координате Qx с вычислением Qy

```bash
dart run bin/d.dart <Qx_hex_or_decimal>
```

Где:

- `<Qx_hex_or_decimal>` - координата X целевой точки Q в hex или decimal формате

Программа автоматически вычисляет возможные значения координаты Y на основе уравнения эллиптической кривой y² = x³ + ax + b, и проверяет обе возможные точки (Qx, Qy1) и (Qx, Qy2) на принадлежность кривой secp256k1. Затем производится попытка найти закрытый ключ d, такой что Q = d*G, где G - генератор кривой.

Поскольку для каждой координаты X на эллиптической кривой существуют две возможные координаты Y (y и p-y, где p - модуль поля), программа проверяет обе возможные точки, чтобы найти соответствующий закрытый ключ.

Примеры:

```bash
dart run bin/d.dart 63CED202E36FAE63E37EB3400A22C17A9AD1F102800D6D83C2D33139D3320939
dart run bin/d.dart 0x63CED202E36FAE63E37EB3400A22C17A9AD1F102800D6D83C2D33139D3320939
dart run bin/d.dart 4491824868569347141498685526487009658034377807588263332398145226818874465097
```

## Формат вывода

Программа выводит:

- Исходные данные (закрытый ключ, параметры кривой)
- Промежуточные значения на каждом шаге алгоритма
- Итоговый открытый ключ в HEX формате (X и Y координаты)
- Полный несжатый ключ в формате 04 + X + Y

## Тестирование

Для запуска тестов:

```bash
dart test
```

## Алгоритмы

### Double-and-Add

Программа использует алгоритм Double-and-Add для скалярного умножения точки G на закрытый ключ d:

1. Преобразование закрытого ключа в двоичное представление
2. Для каждого бита (справа налево):
   - Если бит = 1: складываем текущую точку с результатом
   - Удваиваем текущую точку для следующей итерации
3. Результат - открытый ключ (точка на кривой)

### BSGS (Baby-Step Giant-Step)

Алгоритм решения задачи дискретного логарифмирования:

1. Генерация "малых шагов" (baby-steps) - вычисление точек [1]G, [2]G, ..., [m]G
2. Индексация полученных точек по 80-битным префиксам координат X
3. Подготовка "больших шагов" (giant-steps) - вычисление [m]G
4. Поиск совпадений между giant-steps и baby-steps
5. При нахождении совпадения вычисляется искомый ключ d

### Поиск по координате X (d.dart)

Алгоритм поиска закрытого ключа по заданной координате X:

1. Вычисление возможных значений Y на основе уравнения кривой y² = x³ + ax + b
2. Для каждого возможного значения Y:
   - Проверка принадлежности точки кривой secp256k1
   - Проверка, что точка находится на той же кривой, что и генератор G
   - Попытка найти закрытый ключ d в заданном диапазоне методом перебора
